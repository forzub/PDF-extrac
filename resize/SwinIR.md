# SwinIR

## üöß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:
- –ù–µ—Ç pip-–ø–∞–∫–µ—Ç–∞:
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–µ —á–µ—Ä–µ–∑ pip install, –∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è —Å GitHub –∏ —Ä—É—á–Ω—ã–º –∑–∞–ø—É—Å–∫–æ–º —Å–∫—Ä–∏–ø—Ç–æ–≤.
- ‚Üí –ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ, –Ω–æ –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –¥–µ–π—Å—Ç–≤–∏–π.

**Torch –≤–µ—Ä—Å–∏–∏:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Å PyTorch ‚â•1.7, –Ω–æ –±–µ–∑ –æ—Å–æ–±–æ–π –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏. –õ—É—á—à–µ –±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Ç–∞–Ω–¥–µ–º PyTorch + torchvision, –∫–æ—Ç–æ—Ä—ã–π —É —Ç–µ–±—è —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.

**NumPy –∏ OpenCV:**
- –ï—Å–ª–∏ —É —Ç–µ–±—è –æ–Ω–∏ —É–∂–µ —Å—Ç–æ—è—Ç (–∞ —Å—Ç–æ—è—Ç), –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –±—ã—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–æ.

**–ù–µ—Ç GUI, —Ç–æ–ª—å–∫–æ Python API –∏–ª–∏ CLI:**
- –í—Å—ë –¥–µ–ª–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã. –ó–∞—Ç–æ –º–æ–∂–Ω–æ –≥–∏–±–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å.

Pretrained –º–æ–¥–µ–ª–∏ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é (–∏–ª–∏ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç).

## ‚úÖ –ß—Ç–æ —Ö–æ—Ä–æ—à–µ–≥–æ:
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç CUDA ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –Ω–∞ CPU (–º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç).
- –ë–µ–∑ –∫–∞–∫–∏—Ö-—Ç–æ –∂—ë—Å—Ç–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤—Ä–æ–¥–µ pybind, cl.exe –∏ –¥—Ä—É–≥–∏—Ö –∞–¥—Å–∫–∏—Ö –ø–ª—è—Å–æ–∫.
- –£–∂–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω –∏ —Å—Ç–∞–±–∏–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–∞—É—á–Ω—ã—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏—è—Ö.

## üåÄ –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã –¥–ª—è SwinIR
–í—ã–ø–æ–ª–Ω–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:

```bash
python -m venv swinir_env
```
–ó–∞—Ç–µ–º –∞–∫—Ç–∏–≤–∏—Ä—É–π –µ—ë:

```
.\swinir_env\Scripts\Activate.ps1
```

## üîß –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è SwinIR

```bash
git clone https://github.com/JingyunLiang/SwinIR.git
cd SwinIR
```
## üîß –£—Å—Ç–∞–Ω–æ–≤–∏–º –≤—Å—ë, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è SwinIR:
```bash
pip install numpy opencv-python matplotlib scikit-image tqdm yacs
pip install requests
pip install timm
```

## üõ† –ü—Ä–æ–≤–µ—Ä–∏–º, –≤—Å—ë –ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏–ª–æ—Å—å:
```bash
pip list
```

## üß™ –°–∫–∞—á–∏–≤–∞–µ–º –º–æ–¥–µ–ª—å
–ü–µ—Ä–µ–π–¥–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é SwinIR, –µ—Å–ª–∏ —Ç—ã –µ—â—ë –Ω–µ —Ç–∞–º:

```bash
cd SwinIR
```
–¢–µ–ø–µ—Ä—å –∫–∞—á–∞–µ–º –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è x4):

```bash
wget https://github.com/JingyunLiang/SwinIR/releases/download/v0.0/003_realSR_BSRGAN_DFOWMFC_s64w8_SwinIR-M_x4_GAN.pth -P model_zoo
```

–ï—Å–ª–∏ wget –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ‚Äî –º–æ–∂–Ω–æ —Å–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é –∏ –ø–æ–ª–æ–∂–∏—Ç—å –≤ SwinIR/model_zoo/:
- [–°–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å ](https://github.com/JingyunLiang/SwinIR/releases)
- 003_realSR_BSRGAN_DFOWMFC_s64w8_SwinIR-M_x4_GAN.pth
- –∏–ª–∏ –±–ª–∏–∑–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å L –∏ x4 –∏ GAN –≤ –∏–º–µ–Ω–∏

üóÇ **–¢–∏–ø–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–Ω—É—Ç—Ä–∏ SwinIR, –Ω–∞ –≤—Å—è–∫–∏–π —Å–ª—É—á–∞–π:**

```go
SwinIR/
‚îú‚îÄ‚îÄ main_test_swinir.py
‚îú‚îÄ‚îÄ model_zoo/
‚îÇ   ‚îî‚îÄ‚îÄ 003_realSR_BSRGAN_DFOWMFC_s64w8_SwinIR-M_x4_GAN.pth
‚îú‚îÄ‚îÄ testsets/
‚îÇ   ‚îî‚îÄ‚îÄ real/
‚îÇ       ‚îî‚îÄ‚îÄ your_image.jpg
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îî‚îÄ‚îÄ swinir_real_sr_x4/
```


## ‚úÖ –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∏–º —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ

–°–æ–∑–¥–∞–π –ø–∞–ø–∫—É —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ ./testsets/real, –∏ –ø–æ–ª–æ–∂–∏ —Ç—É–¥–∞ —Ö–æ—Ç—å –æ–¥–∏–Ω .png –∏–ª–∏ .jpg.

## ‚úÖ –®–∞–≥ 2: –ó–∞–ø—É—Å–∫–∞–µ–º –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç
–¢–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω–∏ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –ø—Ä—è–º–æ –≤ PowerShell –∏–∑ –ø–∞–ø–∫–∏ SwinIR:

```powershell
python main_test_swinir.py --task real_sr --scale 4 --large_model --model_path model_zoo/003_realSR_BSRGAN_DFOWMFC_s64w8_SwinIR-L_x4_GAN.pth --folder_lq testsets/real_sr --tile 0
```
üß† –û–±—ä—è—Å–Ω–µ–Ω–∏–µ:
- -task real_sr ‚Äî –∑–∞–¥–∞—á–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
- -scale 4 ‚Äî —É–≤–µ–ª–∏—á–∏–º –≤ 4 —Ä–∞–∑–∞.
- -model_path ‚Äî –ø—É—Ç—å –∫ —Ç–≤–æ–µ–π –º–æ–¥–µ–ª–∏.
- -folder_lq . ‚Äî –ø–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º (—Ç–µ–∫—É—â–∞—è).
- -tile 128 ‚Äî —Ä–∞–∑–¥–µ–ª—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –∫—É—Å–∫–∏, —á—Ç–æ–±—ã –Ω–µ —É–ø–∞—Å—Ç—å —Å Out of Memory.

- –°–∫—Ä–∏–ø—Ç main_test_swinir.py –∏—â–µ—Ç –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–µ (--folder_lq).
- –¢–æ –µ—Å—Ç—å –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å —Ç—É–¥–∞ –ª—é–±–æ–π —Ñ–∞–π–ª: test.png, image.tif, kitty.jpg ‚Äî –≤—Å—ë —Å–≥–æ–¥–∏—Ç—Å—è.
- –û–Ω –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏ .png, .jpg, .jpeg, .bmp, .tif, .tiff





